<!doctype html>
<html lang="es">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Carta interactiva - 9 meses</title>
<style>
  :root{
    --bg:#0f1115;
    --card:#fff8f2;
    --accent:#ff6b8a;
    --muted:#6b6b72;
    --glass: rgba(255,255,255,0.06);
    --radius:18px;
    --transition:300ms cubic-bezier(.2,.9,.3,1);
  }
  html,body{height:100%;margin:0;font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;}
  body{
    background: radial-gradient(1200px 600px at 10% 10%, rgba(255,107,138,0.06), transparent),
                radial-gradient(900px 500px at 90% 90%, rgba(100,210,255,0.03), transparent),
                var(--bg);
    display:flex;align-items:center;justify-content:center;
    padding:24px;
    -webkit-font-smoothing:antialiased;color: #eef2f6;
    overflow:hidden;
  }

  /* layout */
  .wrap{max-width:980px;width:100%;display:flex;gap:28px;align-items:center;justify-content:center;flex-wrap:wrap;}
  .stage{
    width:360px; height:480px; position:relative;
    display:flex;align-items:center;justify-content:center;
    perspective:1200px;
  }

  /* envelope */
  .envelope{
    width:320px;height:220px;position:relative;transform-style:preserve-3d;cursor:pointer;
    transition:transform var(--transition);
  }
  .envelope .back, .envelope .front, .envelope .flap{
    position:absolute;left:0;right:0;margin:auto;
    width:100%;height:100%;border-radius:14px;box-shadow: 0 8px 30px rgba(0,0,0,0.6);
    background: linear-gradient(180deg,#fff 0%, #fffefc 100%);
    overflow:hidden;
  }
  .envelope .back{z-index:1;transform:translateZ(-2px);background:linear-gradient(180deg,#fff,#fffefc);}
  .envelope .front{z-index:3;transform-origin:center top; background:
    linear-gradient(180deg,#fff8f2,#fff);}
  .envelope .flap{
    height:120px;top:-10px;z-index:5;border-radius:18px 18px 10px 10px;
    transform-origin:top center; transform:rotateX(0deg);
    background: linear-gradient(180deg,#fffbf9,#fff6f3);
  }

  /* open state */
  .envelope.open .flap{transform:rotateX(-180deg) translateY(-10px);box-shadow:none;}
  .envelope.open .front{transform:translateY(40px) scale(0.98);opacity:0.98;}
  .envelope.open{transform:translateY(-6px) rotateX(6deg);}

  /* letter */
  .letter{
    position:absolute;top:16px;left:50%;transform:translateX(-50%) translateY(120px);
    width:86%;height:72%;background:var(--card);border-radius:12px;padding:22px;
    box-shadow:0 10px 30px rgba(0,0,0,0.45);z-index:2;opacity:0;transition:all 420ms cubic-bezier(.2,.9,.3,1);
    display:flex;flex-direction:column;justify-content:flex-start;
    gap:10px;color:#222;
  }
  .envelope.open .letter{transform:translateX(-50%) translateY(12px);opacity:1;}

  .letter h1{margin:0;font-size:20px;color:var(--accent);letter-spacing:0.4px}
  .letter p{margin:0;color:#333;line-height:1.45;font-size:15px}
  .letter .meta{font-size:13px;color:var(--muted);margin-top:6px}

  /* decorations (hearts floating) */
  .hearts{position:absolute;bottom:-20px;left:50%;transform:translateX(-50%);z-index:6;pointer-events:none}
  .heart{width:18px;height:18px;display:inline-block;margin:4px;opacity:0;transform:translateY(8px) scale(.6);animation:pop 1300ms forwards;}
  .heart svg{width:100%;height:100%}

  @keyframes pop{
    0%{opacity:0;transform:translateY(12px) scale(.6)}
    30%{opacity:1;transform:translateY(-8px) scale(1.05)}
    100%{opacity:0;transform:translateY(-120px) scale(.8)}
  }

  /* right column: little panel with mini interactions */
  .panel{
    width:320px;min-height:420px;background:linear-gradient(180deg,rgba(255,255,255,0.03),transparent);
    border-radius:var(--radius);padding:18px;backdrop-filter: blur(6px);box-shadow:0 6px 28px rgba(0,0,0,0.4);
    display:flex;flex-direction:column;gap:12px;align-items:stretch;
  }
  .panel h2{margin:0;color:#fff;font-size:18px}
  .panel .note{color:var(--muted);font-size:14px}
  .btn{
    background:linear-gradient(90deg,var(--accent),#ff9bb0);border:0;padding:10px 14px;border-radius:12px;color:white;
    font-weight:600;cursor:pointer;transition:transform 160ms;
  }
  .btn:active{transform:scale(.98)}
  .controls{display:flex;gap:8px;flex-wrap:wrap}

  /* small icons row */
  .icons{display:flex;gap:8px;align-items:center}
  .icon{
    width:44px;height:44px;border-radius:10px;background:var(--glass);display:flex;align-items:center;justify-content:center;
    border:1px solid rgba(255,255,255,0.03);cursor:pointer;transition:all 180ms;
  }
  .icon:hover{transform:translateY(-4px);box-shadow:0 6px 18px rgba(0,0,0,0.45);}

  /* footer */
  .foot{margin-top:auto;color:var(--muted);font-size:13px;text-align:center}

  /* responsive */
  @media (max-width:900px){
    .wrap{flex-direction:column;align-items:center}
    .stage{width:92vw;height:auto}
    .panel{width:92vw;max-width:640px}
  }

  /* cursor sparkle */
  .spark{position:fixed;pointer-events:none;z-index:9999;mix-blend-mode:screen;opacity:.9;transform:translate(-50%,-50%);width:12px;height:12px;border-radius:50%;background:radial-gradient(circle, rgba(255,255,255,0.95), rgba(255,255,255,0.2) 40%, transparent 60%);}
</style>
</head>
<body>
<div class="wrap">
  <div class="stage">
    <div class="envelope" id="envelope" aria-label="Sobre - haz click para abrir">
      <div class="back"></div>
      <div class="letter" id="letter" role="article" aria-live="polite">
        <h1>Para ti, mi amor ♥</h1>
        <p class="meta">Hoy cumplimos <strong>9 meses</strong>. — Reemplaza este texto por lo que tú sientas.</p>
        <div class="letter-content" style="margin-top:12px;">
          <!-- Mensaje editable -->
          <p>Salomé,</p>
          <p>Hace nueve meses empezó una cosa que aún me sorprende: tu risa, tus detalles, la forma en que me miras. Cada día contigo me inspira a ser mejor. Gracias por tu paciencia, por las caminatas, por las empanadas, y por creer en mí. Prometo seguir construyendo momentos, canciones y sueños a tu lado.</p>
          <p>Te quiero con todo,</p>
          <p><strong>Tu Parcero</strong></p>
        </div>
      </div>
      <div class="front"></div>
      <div class="flap"></div>
      <div class="hearts" id="hearts"></div>
    </div>
  </div>

  <div class="panel" aria-hidden="false">
    <h2>Detalles & efectos</h2>
    <div class="note">Toca el sobre para abrir. Usa los botones para efectos extra o cambia el mensaje en el HTML.</div>
    <div class="controls">
      <button class="btn" id="openBtn">Abrir / Cerrar</button>
      <button class="btn" id="spinBtn">Súper corazón</button>
    </div>

    <div style="display:flex;gap:8px;margin-top:10px;">
      <div class="icon" id="smallHeart" title="Enviar corazones">
        <!-- SVG corazón -->
        <svg width="22" height="22" viewBox="0 0 24 24" fill="none" aria-hidden="true"><path d="M12 21s-7.5-5.5-10-9c-2.5-3.2 0-6 2.5-6 2.2 0 3.6 1.6 4.5 2.6.9-1 2.3-2.6 4.5-2.6 2.5 0 5 2.8 2.5 6-2.5 3.5-10 9-10 9z" stroke="#fff" stroke-width="1" stroke-linecap="round" stroke-linejoin="round"/></svg>
      </div>
      <div class="icon" id="confetti" title="Confeti (suave)">
        <svg width="22" height="22" viewBox="0 0 24 24" fill="none"><path d="M4 7h.01M20 17h.01" stroke="#fff" stroke-width="1.2" stroke-linecap="round"/></svg>
      </div>
      <div class="icon" id="download" title="Copiar mensaje">
        <svg width="22" height="22" viewBox="0 0 24 24" fill="none"><path d="M12 3v12M8 11l4-4 4 4M21 21H3" stroke="#fff" stroke-width="1.2" stroke-linecap="round" stroke-linejoin="round"/></svg>
      </div>
    </div>

    <div class="foot">Personaliza el texto dentro de <code>&lt;div class="letter-content"&gt;</code></div>
  </div>
</div>

<!-- sparkle cursor -->
<div id="spark" class="spark" style="display:none;"></div>

<script>
  // short helpers
  const $ = (s)=>document.querySelector(s);
  const envelope = $('#envelope');
  const openBtn = $('#openBtn');
  const spinBtn = $('#spinBtn');
  const heartsWrap = $('#hearts');
  const smallHeart = $('#smallHeart');
  const confetti = $('#confetti');
  const download = $('#download');
  const spark = document.getElementById('spark');

  let open = false;

  function toggleEnvelope(userClick){
    open = !open;
    envelope.classList.toggle('open', open);
    if(open) spawnHearts(6);
    if(userClick) envelope.animate([{transform:'translateY(0)'},{transform:'translateY(-6px)'}],{duration:250,fill:'forwards'});
  }

  envelope.addEventListener('click',()=>toggleEnvelope(true));
  openBtn.addEventListener('click',()=>toggleEnvelope(false));

  // spawn hearts
  function spawnHearts(n=6){
    for(let i=0;i<n;i++){
      const el = document.createElement('div');
      el.className='heart';
      el.style.left = (50 + (Math.random()-0.5)*160) + 'px';
      el.style.animationDelay = (i*160)+'ms';
      el.innerHTML = `<svg viewBox="0 0 24 24" fill="none"><path d="M12 21s-7.5-5.5-10-9c-2.5-3.2 0-6 2.5-6 2.2 0 3.6 1.6 4.5 2.6.9-1 2.3-2.6 4.5-2.6 2.5 0 5 2.8 2.5 6-2.5 3.5-10 9-10 9z" fill="${getComputedStyle(document.documentElement).getPropertyValue('--accent') || '#ff6b8a'}" /></svg>`;
      heartsWrap.appendChild(el);
      setTimeout(()=>el.remove(),1600 + i*300);
    }
  }

  // "super heart" spin effect
  spinBtn.addEventListener('click',()=>{
    const fl = envelope.querySelector('.flap');
    fl.animate([{transform:'rotateX(-180deg) translateY(-10px) scale(1)'},{transform:'rotateX(-180deg) translateY(-10px) scale(1.06)'},{transform:'rotateX(-180deg) translateY(-10px) scale(1)'}],{duration:800});
    spawnHearts(12);
  });

  smallHeart.addEventListener('click',()=>spawnHearts(8));

  // confetti - soft squares
  confetti.addEventListener('click',()=>{
    for(let i=0;i<22;i++){
      const c = document.createElement('div');
      c.style.position='fixed';
      c.style.left=(Math.random()*100)+'vw';
      c.style.top=(Math.random()*100)+'vh';
      c.style.width='8px';c.style.height='8px';
      c.style.background=['#ff6b8a','#ffd36b','#9ee3ff','#b29bff'][Math.floor(Math.random()*4)];
      c.style.opacity='0.95';
      c.style.borderRadius='2px';
      c.style.zIndex=9999;
      document.body.appendChild(c);
      c.animate([{transform:'translateY(0) rotate(0deg)', opacity:1},{transform:`translateY(${200+Math.random()*260}px) rotate(${Math.random()*360}deg)`, opacity:0}],{duration:1100+Math.random()*900, easing:'cubic-bezier(.2,.8,.2,1)'});
      setTimeout(()=>c.remove(),2200);
    }
  });

  // copy message to clipboard
  download.addEventListener('click',async()=>{
    const txt = document.querySelector('.letter-content').innerText;
    try{
      await navigator.clipboard.writeText(txt);
      download.animate([{transform:'scale(1)'},{transform:'scale(.96)'}],{duration:180});
      alert('Mensaje copiado. Pega donde quieras o guárdalo.');
    }catch(e){
      alert('No se pudo copiar automáticamente. Selecciona y copia el texto manualmente.');
    }
  });

  // tiny cursor sparkle
  document.addEventListener('mousemove', (e)=>{
    spark.style.display='block';
    spark.style.left = e.clientX + 'px';
    spark.style.top = e.clientY + 'px';
    spark.style.width = Math.random()*14 + 6 + 'px';
    spark.style.height = spark.style.width;
    spark.style.opacity = 0.9;
  });
  document.addEventListener('mouseleave', ()=>{ spark.style.display='none' });

  // accessibility: open with Enter/Space when focused
  envelope.setAttribute('tabindex','0');
  envelope.addEventListener('keydown',(e)=>{
    if(e.key==='Enter' || e.key===' ') { e.preventDefault(); toggleEnvelope(true); }
  });

  // small animation on load
  window.addEventListener('load', ()=>{
    envelope.animate([{transform:'translateY(8px)'},{transform:'translateY(0)'}],{duration:500,easing:'cubic-bezier(.2,.9,.3,1)'});
  });

  // Make letter editable in-place (double click)
  const letterContent = document.querySelector('.letter-content');
  letterContent.addEventListener('dblclick', ()=>{
    const current = letterContent.innerText.trim();
    const val = prompt('Editar mensaje (usa HTML simple o texto):', current) || current;
    letterContent.innerHTML = val.replace(/\n/g,'<br>');
  });
</script>
</body>
</html>